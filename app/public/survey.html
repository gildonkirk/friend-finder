<!DOCTYPE html>
<html>
<head>
	<title>Friend Finder</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
</head>
<body>
	<div class="container">
		<h1>Survey Questions</h1>
		<form class="container">
			<div class="form-group">
				<label for="name">Name</label>
				<input type="text" class="form-control" id="name" placeholder="Enter name">
			</div>
			<div class="form-group">
				<label for="photo">Link to Photo</label>
				<input type="text" class="form-control" id="photo" placeholder="Enter link">
			</div>
			<div class="instructions">
				<h2 id="instructionsHeader">When done, we will find the best friend for you based on your answers!</h2>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q1">Question One</label><br>
				<label class="question">Do you like Game of Thrones?</label>
				<select class="form-control" id="q1">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q2">Question Two</label><br>
				<label class="question">Do you like comic books?</label>
				<select class="form-control" id="q2">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q3">Question Three</label><br>
				<label class="question">Do you like video games?</label>
				<select class="form-control" id="q3">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q4">Question Four</label><br>
				<label class="question">Do you like movies?</label>
				<select class="form-control" id="q4">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q5">Question Five</label><br>
				<label class="question">Do you like music?</label>
				<select class="form-control" id="q5">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q6">Question Six</label><br>
				<label class="question">Do you like beer?</label>
				<select class="form-control" id="q6">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q7">Question Seven</label><br>
				<label class="question">Do you like traveling?</label>
				<select class="form-control" id="q7">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q8">Question Eight</label><br>
				<label class="question">Do you like coffee?</label>
				<select class="form-control" id="q8">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q9">Question Nine</label><br>
				<label class="question">Do you like pizza?</label>
				<select class="form-control" id="q9">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<div class="form-group">
				<label class="questionTitle" for="q10">Question Ten</label><br>
				<label class="question">Do you like hamburgers?</label>
				<select class="form-control" id="q10">
				 	<option>1</option>
				 	<option>2</option>
				 	<option>3</option>
				 	<option>4</option>
				 	<option>5</option>
				</select>
			</div>
			<button type="submit" class="btn btn-primary btnSubmit" data-toggle="modal" data-target="#exampleModal">Submit</button>
		</form>
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						  <span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						...
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary">Save changes</button>
					</div>
				</div>
			</div>
		</div>
	</div>

<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
<script>
	var currentUrl = window.location.origin;
	$('.btnSubmit').on('click', function() {
		event.preventDefault();
		var scoresArray = [
			$('#q1').val().trim(),
			$('#q2').val().trim(),
			$('#q3').val().trim(),
			$('#q4').val().trim(),
			$('#q5').val().trim(),
			$('#q6').val().trim(),
			$('#q7').val().trim(),
			$('#q8').val().trim(),
			$('#q9').val().trim(),
			$('#q10').val().trim()
		];
		var integerArray = scoresArray.map(Number);
		// need to parsInt these values
		var newFriend = {
			name: $('#name').val().trim(),
			photo: $('#photo').val().trim(),
			scores: integerArray
		}
		console.log(newFriend);

		$.post(currentUrl + '/api/friends', newFriend, function(data) {
			$('#q1').val('');
			$('#q2').val('');
			$('#q3').val('');
			$('#q4').val('');
			$('#q5').val('');
			$('#q6').val('');
			$('#q7').val('');
			$('#q8').val('');
			$('#q9').val('');
			$('#q10').val('');
		}).done(getFriends());
	});

	function getFriends() {
		$.ajax({ url: currentUrl + "/api/friends", method: "GET" })
		.done(function(friends) {
			var diffResults = [];
			var sums = [];
			var user = friends.length - 1;
			for(x = 0; x < friends.length-1; x++) {
				for(i = 0; i < friends[1].scores.length; i++) {
					diffResults.push(Math.abs(friends[x].scores[i] - friends[user].scores[i]));
				};
				sums.push(diffResults.reduce(getSum));
				diffResults = [];
			}
			// take these sums and figure out which is smallest, that becomes the users match
			console.log(sums);
			var index = 0;
			var value = sums[0];
			for(i = 0; i < sums.length; i++) {
				if(sums[i] < value) {
					value = sums[i];
					index = i;
					console.log(value);
					console.log(index);
				}
			}
			// alert('You have been paired with ' + friends[index].name + '!');
		})
	};

	Array.min = function(array) {
		return Math.min.apply(Math, array);
	};

	function getSum(total, num) {
		return total + num;
	};

</script>
</body>
</html>